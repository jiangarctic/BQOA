<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="FlswclMapper">
	<insert id="insertNewFlswcl" parameterType="pd" flushCache="false">
		insert into sys_flswcl (clientName,reportNum,inquireTime,inquireType,inquireer,
		inquireerPhone,inquireerEmail,reportBrief,givenFiles,suggestions,worker,workTime,
		workerPhone,approver,resultFileName,replyTime,replyType,genFileUrl , genFileName , genTime, status)
		 values(#{clientName},#{reportNum},#{inquireTime},#{inquireType},#{inquireer},
		#{inquireerPhone},#{inquireerEmail},#{reportBrief},#{givenFiles},#{suggestions},#{worker},#{workTime},
		#{workerPhone},#{approver},#{resultFileName},#{replyTime},#{replyType},#{genFileUrl} , #{genFileName} , #{genTime},#{status});
	</insert>
	
	<select id="queryAllflswcl" resultType="pd">
		select * from sys_flswcl where 1=1 
			<if test="query_clientName !='' or query_clientName !=null">
				and clientName like CONCAT('%','${query_clientName}','%' ) 
			</if>
			<if test="query_worker !='' or query_worker !=null">
				and worker  like CONCAT('%','${query_worker}','%' ) 
			</if>
		 ORDER BY id desc 
		 <if test="startIndex!=null and rows!=null">
		 limit #{startIndex} , #{rows} 
		 </if>
		 
	</select>
	<select id="queryflswcl_me" resultType="pd">
		select * from sys_flswcl where worker=#{worker} ORDER BY id desc limit #{startIndex} , #{rows}
	</select>
	<select id="queryflswcl_WaitMe" resultType="pd">
		select * from sys_flswcl where approver=#{approver} ORDER BY id desc limit #{startIndex} , #{rows}
	</select>
	<select id="queryflswcl_HasApproved" resultType="pd">
		select * from sys_flswcl where approver=#{approver} and status=#{status} ORDER BY id desc limit #{startIndex} , #{rows}
	</select>
	
	<select id="queryOneFlswcl" parameterType="pd" resultType="pd">
		select * from sys_flswcl where 1=1 and id=#{id}
	</select>
	<select id="queryFlswclAllCount"  resultType="pd">
		select count(*) total from sys_flswcl 
	</select>
	<select id="queryFlswclMeCount" parameterType="pd" resultType="pd">
		select count(*) total from sys_flswcl where worker=#{worker}
	</select>
	<select id="queryFlswclWaitMeCount" parameterType="pd" resultType="pd">
		select count(*) total from sys_flswcl where approver=#{approver} 
	</select>
	<select id="queryFlswclHasApprovedCount" parameterType="pd" resultType="pd">
		select count(*) total from sys_flswcl where approver=#{approver} and status=#{status}
	</select>
	
</mapper>